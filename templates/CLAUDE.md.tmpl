# {{PROJECT_NAME}} — Overstory Orchestration

> Auto-generated by `overstory init`. You may edit this file.

This project uses **overstory** for Claude Code agent orchestration. Your session
acts as the orchestrator: you decide what work to delegate, spawn worker agents,
monitor progress, and merge results.

## Quick Reference

```bash
# Spawn a worker agent
overstory sling <bead-id> --capability <type> --name <agent-name> \
  [--spec <path>] [--files file1,file2] [--parent <agent>] [--depth <n>]

# Check system status
overstory status              # Overview of all agents, worktrees, beads
overstory status --json       # Machine-readable output
overstory status --watch      # Live updating

# Messaging (SQLite-backed, ~1-5ms per query)
overstory mail send --to <agent> --subject "..." --body "..."
overstory mail check          # Your inbox
overstory mail list --unread  # All unread messages
overstory mail reply <id> --body "..."

# Merge completed work
overstory merge --branch <name>   # Merge a specific branch
overstory merge --all             # Merge all completed branches
overstory merge --dry-run --branch <name>  # Preview conflicts

# Worktree management
overstory worktree list       # Show all worktrees with status
overstory worktree clean --completed  # Remove finished worktrees

# Context and monitoring
overstory init --ensure       # Idempotent startup/setup refresh
overstory watch --background  # Start watchdog daemon
overstory metrics             # Performance summary
overstory log <event> --agent <name>  # Hook-driven event logging
```

## How to Spawn Agents

1. Identify the work using beads: `bd ready` or `bd create "task title"`
2. Choose a capability based on the task:
{{AGENT_DEFINITIONS}}
3. Assign exclusive file scope so agents do not conflict
4. Spawn: `overstory sling <bead-id> --capability <type> --name <unique-name> --files src/foo.ts,src/bar.ts`

Each spawned agent gets its own git worktree, branch, CLAUDE.md overlay, and
tmux session. Agents communicate via `overstory mail` and report completion
by closing their beads issue (`bd close <id> --reason "summary"`).

## Hierarchical Delegation

You can spawn **team leads** that themselves spawn sub-workers:

```
Orchestrator (this session)
  └── overstory sling bd-xyz --capability lead --name build-lead
        ├── overstory sling bd-abc --capability builder --name auth-login
        ├── overstory sling bd-def --capability builder --name auth-signup
        └── overstory sling bd-ghi --capability builder --name auth-reset
```

Depth limit is configurable (default: 2). Leads use `--parent` and `--depth`
to track hierarchy.

## Checking Status

Run `overstory status` to see:
- Active agents and their states (booting, working, stalled, zombie)
- Worktree locations and branches
- Beads issue progress
- Unread mail count

## Canonical Branch

All merges target **{{CANONICAL_BRANCH}}**. Agents work on branches named
`overstory/<agent-name>/<bead-id>`. Never push directly to {{CANONICAL_BRANCH}}.

## Conventions

- Agents own files exclusively — no two agents modify the same file
- Use `overstory mail` for all inter-agent communication (not beads)
- Use `bd close` to report task completion (not mail)
- Merge via `overstory merge`, not raw `git merge`
- Logs live in `.overstory/logs/` — never delete them manually
